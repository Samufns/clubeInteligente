.head 0 +  Application Description: Centura SQLWindows Standard Application Template
.data CLASSPROPSSIZE
0000: 3B00
.enddata
.data CLASSPROPS
0000: 557365476C6F6261 6C50617468000400 0100000000417070 506174684C656E00
0020: 0400030000000041 7070506174680003 002E2E5C00000000 000000
.enddata
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000840100 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE5FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? No
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: DbvLib.apl
.head 2 -  ! File Include: SonConstantes.apl
.head 2 -  File Include: VtArray.apl
.head 2 -  File Include: Microsoft XML.apl
.head 2 -  ! File Include: SonSerializaObjeto.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 4214296097
0000: 120100006D000000 0000000000000000 02000009000000B8 0300001019000000
0020: 010000FE00FFA3D1 030019B5000100FF FF68EA03001900ED 0100FF3F03045800
0040: 00190001FB00FF8F 1C0400D6190001FE 00FFA335040019B5 000100FFFF684E04
0060: 001900ED0100FF3F 67045A00190001FB 00FF8F8004005619 000100FE00FF03
.enddata
.head 2 +  Internal Functions
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 1095621592
0000: 7E0700009D030000 0000000000000000 0200000C00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F04003C00 0011630044425655
0040: 5355415200494F5F 5665746F72002200 0000010000004F04 0000A10700000001
0060: E0CC110000003F01 80005B0000000100 0000000F70634469 616C6F0067446566
0080: 61756C7460D60000 0007006F0400E102 000000FFBF045900 040002FB00FF0F08
00A0: 000000D019000000 01FE00FF83210000 0019B5000100FFFF 603A0000001900ED
00C0: 0100FF3F53005800 00040003F8000000 FF0F57000000D604 0002FE00FF630180
00E0: 5B00860200127063 FF0F546162D6B200 000700B70400F602 00FFDF04AC000400
0100: 02FD00FF37080019 4B00010000FFFFCD 210019DA000100FF 7F3AB3001900F601
0120: 00FFDF53AC000400 03FD00FF37570004 6B000200FFFF0101 801D000000030300
0140: 087063436C076540 000000F602009619 000100FE00FF9B19 0004B5000300FFFF
0160: 9801801D0004E100 0B7063074B657940 00D90002005B1900 01FA0000FF6F1900
0180: D6040003FE00FF43 0180040000000500 0000106663440042 4C697374614F6288
01A0: 6A6574732200E800 010000AD040007D5 0001CCFD00870180 1900000006000000
01C0: 0C7063004D6F7573 6557686510656C22 00000100BC000019 B5000100FFFF9801
01E0: 8004000701000966 63536F75006E6465 782A000000F40100 00863A0001070082
0200: 0001002405001E00 800100FC00000301 800C000000840800 000A6663016E4D65
0220: 7465725EB0000000 0300B70400F60300 FFDF04AC00040003 FD00FF370800046B
0240: 000300FFFF05019D 0000000900000000 0A5F457272006F72 426173658A01C200
0260: 0D0000005B190001 FA0000FF6F1900D6 190001FE00FF8332 00000019B5000100
0280: FFFF604B00000019 00ED0100FF3F6400 580000040002FB00 FF0F68000000D604
02A0: 0002FE00FF836C00 000004B5000200FF FF60700000000400 ED0300FF3F740058
02C0: 0000040002FB00FF 0F78000000D60400 02FE00FF837C0000 0004B5000300FFFF
02E0: 628000000400ED03 00FF3F8400580000 190001FB00FF8F01 805B01000A000000
0300: 076300646B497465 6DDE00D000000700 001B04000102FA00 007F80F20100006F
0320: 0400D6040002FE00 FF9B080019A50001 0000FFFF66210019 00ED0100FFBF3A59
0340: 00040003FB00FF0F 3E000000D6040003 FE00FF8342000000 19B5000100FFFF00
0360: 01807D0000000B00 0000000D63526164 69186F4C69426F78 609A00000005006F
0380: 1900E9010000FFBF 195900190001FB00 FF6F3200D6190001 FE00FF9B4B0019B5
03A0: 000100FFFF666400 1900ED0100FF3F
.enddata
.head 3 +  Functional Class: cDBVUSUARIO
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nID
.head 5 -  String: sNOME
.head 5 -  String: sUSUARIO
.head 5 -  String: sSENHA
.head 5 -  Number: nATIVO
.head 5 -  Number: nPRIMEIROACESSO
.head 5 -  Number: nIDPESSOA
.head 4 +  Functions
.head 5 +  Function: Initialize
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nID_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If Not bInitialized Or nID != nID_p
.head 8 -  Call Reset( )
.head 8 -  Set nID = nID_p
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 
'Select ID,  NOME,  USUARIO,  SENHA,
ATIVO,  PRIMEIROACESSO,  IDPESSOA
Into  :nID,  :sNOME,  :sUSUARIO,  :sSENHA,
:nATIVO,  :nPRIMEIROACESSO,  :nIDPESSOA 
From DBVUSUARIO 
Where ID = :nID_p' )
.head 8 +  If SqlFetchNext( hSqlParam, nFetch )
.head 9 -  Set sNOME = SalStrTrimX( sNOME )
.head 9 -  Set sUSUARIO = SalStrTrimX( sUSUARIO )
.head 9 -  Set sSENHA = SalStrTrimX( sSENHA )
.head 9 -  Set bInitialized = TRUE
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Set bInitialized = FALSE
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nID = NUMBER_Null
.head 7 -  Set sNOME = STRING_Null
.head 7 -  Set sUSUARIO = STRING_Null
.head 7 -  Set sSENHA = STRING_Null
.head 7 -  Set nATIVO = NUMBER_Null
.head 7 -  Set nPRIMEIROACESSO = NUMBER_Null
.head 7 -  Set nIDPESSOA = NUMBER_Null
.head 7 -  Set bInitialized = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Clone
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: oOrigem_p
.head 8 -  Class: cDBVUSUARIO
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nID = oOrigem_p.nID
.head 7 -  Set sNOME = oOrigem_p.sNOME
.head 7 -  Set sUSUARIO = oOrigem_p.sUSUARIO
.head 7 -  Set sSENHA = oOrigem_p.sSENHA
.head 7 -  Set nATIVO = oOrigem_p.nATIVO
.head 7 -  Set nPRIMEIROACESSO = oOrigem_p.nPRIMEIROACESSO
.head 7 -  Set nIDPESSOA = oOrigem_p.nIDPESSOA
.head 7 -  Set bInitialized = FALSE
.head 5 +  Function: Insert
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bUpdate
.head 6 +  Actions
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 +  When SqlError
.head 9 -  Set bUpdate = TRUE
.head 9 -  Return FALSE
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into DBVUSUARIO 
( ID,  NOME,  USUARIO,  SENHA,
ATIVO,  PRIMEIROACESSO,  IDPESSOA )
 Values 
( :nID,  :sNOME,  :sUSUARIO,  :sSENHA,
:nATIVO,  :nPRIMEIROACESSO,  :nIDPESSOA ) ' )
.head 8 +  If bUpdate
.head 9 -  Call Update( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: InsertOrHalt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into DBVUSUARIO 
( ID,  NOME,  USUARIO,  SENHA,
ATIVO,  PRIMEIROACESSO,  IDPESSOA )
 Values 
( :nID,  :sNOME,  :sUSUARIO,  :sSENHA,
:nATIVO,  :nPRIMEIROACESSO,  :nIDPESSOA ) ' )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: Delete
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If VerificaDependencias() And VerificaDependenciasCustom( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Delete From DBVUSUARIO
Where ID = :nID' )
.head 8 -  Call DeleteDependencies( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call Reset( )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: Update
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Update DBVUSUARIO
Set NOME = :sNOME,
USUARIO = :sUSUARIO,
SENHA = :sSENHA,
ATIVO = :nATIVO,
PRIMEIROACESSO = :nPRIMEIROACESSO,
IDPESSOA = :nIDPESSOA 
Where ID = :nID ' )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: VerificaCampos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! Call oErro.Initialize()
.head 7 +  If SalStrLength( sNOME  ) > 254
.head 8 -  Call oErro.AddMessage( ERRO_INTEGRIDADE, 'O tamanho de NOME excede o tamanho permitido.' )
.head 8 -  Return FALSE
.head 7 +  If SalStrLength( sUSUARIO  ) > 12
.head 8 -  Call oErro.AddMessage( ERRO_INTEGRIDADE, 'O tamanho de USUARIO excede o tamanho permitido.' )
.head 8 -  Return FALSE
.head 7 +  If SalStrLength( sSENHA  ) > 100
.head 8 -  Call oErro.AddMessage( ERRO_INTEGRIDADE, 'O tamanho de SENHA excede o tamanho permitido.' )
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: GetClassName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return 'cDBVUSUARIO'
.head 5 +  Function: FazOperacaoDB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nOperacao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bReturn
.head 6 +  Actions
.head 7 -  Set bReturn = ExecutaComandoDB( hSqlParam, nOperacao )
.head 7 -  Return bReturn
.head 5 +  Function: VerificaDependencias
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: RegistraOperacao
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nFuncao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSeqNo
.head 7 -  Date/Time: dtAtual
.head 7 -  String: sFuncao
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'ID\', 0, ' || SalNumberToStrX( nID, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'NOME\', 1, ' || sNOME || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'USUARIO\', 2, ' || sUSUARIO || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'SENHA\', 3, ' || sSENHA || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'ATIVO\', 4, ' || SalNumberToStrX( nATIVO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'PRIMEIROACESSO\', 5, ' || SalNumberToStrX( nPRIMEIROACESSO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'IDPESSOA\', 6, ' || SalNumberToStrX( nIDPESSOA, 7 )  || '  )'  )
.head 7 -  Return TRUE
.head 5 +  Function: GetMaxID
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMAXID
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Select MAX(ID) Into :nMAXID From DBVUSUARIO' )
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 -  Return isNullNumber(nMAXID,0)
.head 5 +  Function: GetNextID
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMAXID
.head 7 -  Number: nMAXIDBloq
.head 6 +  Actions
.head 7 -  Set nMAXID = GetMaxID( hSqlParam )
.head 7 +  If nMAXIDBloq >= nMAXID
.head 8 -  Return (nMAXIDBloq + 1)
.head 7 -  Return (nMAXID + 1)
.head 5 -  ! @CustomMethodsBegin
.head 5 +  Function: InitializeByUsuario
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: spUsuario
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If Not bInitialized Or sUSUARIO != spUsuario
.head 8 -  Call Reset( )
.head 8 -  Set sUSUARIO = spUsuario
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Select ID Into  :nID From DBVUSUARIO Where usuario = :spUsuario ' )
.head 8 +  If SqlFetchNext( hSqlParam, nFetch )
.head 9 -  Return Initialize( hSqlParam, nID )
.head 8 +  Else
.head 9 -  Set bInitialized = FALSE
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Function: VerificaCamposCustom
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: VerificaDependenciasCustom
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: DeleteDependencies
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  ! @CustomMethodsEnd
.head 3 +  Functional Class: cDBVUSUARIO_Vetor
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBListaObjetos
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sOrdemCampos
.head 5 -  String: saAtributosXML[*,2]
.head 5 -  FunctionalVar: oDBVUSUARIO[*]
.head 6 -  Class: cDBVUSUARIO
.head 4 +  Functions
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( oDBVUSUARIO , 1, -1 )
.head 7 +  If sOrdemCampos = ''
.head 8 -  Set sOrdemCampos = ' ID '
.head 7 -  Set bInitialized = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Select
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nInd
.head 7 -  String: sTop
.head 6 +  Actions
.head 7 -  Call Reset()
.head 7 -  Set sWhere = ''
.head 7 -  Call PrepareConditions()
.head 7 -  Set nInd = 0
.head 7 +  If nTopResultados+0 > 0
.head 8 -  Set sTop = ' Top ' || SalNumberToStrX( nTopResultados, 0 )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
Select ID,  NOME,  USUARIO,  SENHA,
ATIVO,  PRIMEIROACESSO,  IDPESSOA
Into  :oDBVUSUARIO[nInd].nID,  :oDBVUSUARIO[nInd].sNOME,  :oDBVUSUARIO[nInd].sUSUARIO,
:oDBVUSUARIO[nInd].sSENHA,  :oDBVUSUARIO[nInd].nATIVO,  :oDBVUSUARIO[nInd].nPRIMEIROACESSO,
:oDBVUSUARIO[nInd].nIDPESSOA 
From DBVUSUARIO ' || sWhere || ' 
Order By ' || sOrdemCampos )
.head 7 +  While SqlFetchNext( hSqlParam, nFetch )
.head 8 -  Set nInd = nInd + 1
.head 7 -  Set nCount = nInd
.head 7 -  Set sOrdemCampos = ''
.head 7 -  Call FreeConditions(  )
.head 7 -  Return nInd
.head 5 +  Function: SelectCount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nInd
.head 6 +  Actions
.head 7 -  Set sWhere = ''
.head 7 -  Call PrepareConditions()
.head 7 -  Set nInd = 0
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
Select Count(*)
into :nCount
From DBVUSUARIO ' || sWhere )
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 -  Return nCount
.head 5 +  Function: SetClassVarNameValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVetorPos
.head 7 -  String: sNomeVar
.head 7 -  String: sValor
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sNomeVar = 'nID'
.head 8 -  Set oDBVUSUARIO[nVetorPos].nID = SalStrToNumber( sValor )
.head 7 +  Else If sNomeVar = 'sNOME'
.head 8 -  Set oDBVUSUARIO[nVetorPos].sNOME = sValor
.head 7 +  Else If sNomeVar = 'sUSUARIO'
.head 8 -  Set oDBVUSUARIO[nVetorPos].sUSUARIO = sValor
.head 7 +  Else If sNomeVar = 'sSENHA'
.head 8 -  Set oDBVUSUARIO[nVetorPos].sSENHA = sValor
.head 7 +  Else If sNomeVar = 'nATIVO'
.head 8 -  Set oDBVUSUARIO[nVetorPos].nATIVO = SalStrToNumber( sValor )
.head 7 +  Else If sNomeVar = 'nPRIMEIROACESSO'
.head 8 -  Set oDBVUSUARIO[nVetorPos].nPRIMEIROACESSO = SalStrToNumber( sValor )
.head 7 +  Else If sNomeVar = 'nIDPESSOA'
.head 8 -  Set oDBVUSUARIO[nVetorPos].nIDPESSOA = SalStrToNumber( sValor )
.head 7 -  Return TRUE
.head 5 +  Function: GetClassVarNameValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  FunctionalVar: (no name)
.head 8 -  Class: Variant
.head 6 +  Parameters
.head 7 -  String: sNomeVar
.head 7 -  Number: nVetorPos
.head 6 +  Static Variables
.head 7 -  FunctionalVar: vParamExport
.head 8 -  Class: Variant
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sNomeVar = 'nID'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIO[nVetorPos].nID , VT_R8 )
.head 7 +  Else If sNomeVar = 'sNOME'
.head 8 -  Call vParamExport.SetString( oDBVUSUARIO[nVetorPos].sNOME)
.head 7 +  Else If sNomeVar = 'sUSUARIO'
.head 8 -  Call vParamExport.SetString( oDBVUSUARIO[nVetorPos].sUSUARIO)
.head 7 +  Else If sNomeVar = 'sSENHA'
.head 8 -  Call vParamExport.SetString( oDBVUSUARIO[nVetorPos].sSENHA)
.head 7 +  Else If sNomeVar = 'nATIVO'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIO[nVetorPos].nATIVO , VT_R8 )
.head 7 +  Else If sNomeVar = 'nPRIMEIROACESSO'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIO[nVetorPos].nPRIMEIROACESSO , VT_R8 )
.head 7 +  Else If sNomeVar = 'nIDPESSOA'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIO[nVetorPos].nIDPESSOA , VT_R8 )
.head 7 -  Return vParamExport
.head 5 +  Function: GetClassName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return 'cDBVUSUARIO'
.head 5 +  Function: ConditionOk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVetorPos
.head 7 -  String: sColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Date/Time: dtReturn
.head 7 -  Number: nIndice
.head 7 -  Number: nError
.head 7 -  Number: nErrorPos
.head 7 -  Number: nReturn
.head 7 -  String: sCondicao
.head 7 -  String: sReturn
.head 7 -  Window Handle: hWndReturn
.head 6 +  Actions
.head 7 -  Set nIndice = VisArrayFindString( sColunasLog, sColuna )
.head 7 +  If nIndice >= 0
.head 8 -  Set sCondicao = VisStrSubstitute( sConditionsLog[nIndice], '%COLUNA', 'oDBVUSUARIO[ nVetorPos ].' || sColuna )
.head 8 -  Call SalCompileAndEvaluate( sCondicao, nError, nErrorPos, nReturn, sReturn, dtReturn, hWndReturn, TRUE, SalContextCurrent( ) )
.head 8 -  Return nReturn
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Function: ProcessaReg
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nLinha
.head 7 -  String: sOperacao
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sOperacao = '11'
.head 8 -  Return oDBVUSUARIO[nLinha].Insert( hSqlParam )
.head 7 +  Else If sOperacao = '22'
.head 8 -  Return oDBVUSUARIO[nLinha].Delete( hSqlParam )
.head 7 +  Else If sOperacao = '33'
.head 8 -  Return oDBVUSUARIO[nLinha].Update( hSqlParam )
.head 5 -  ! @ArrayCustomMethodsBegin
.head 5 -  ! @ArrayCustomMethodsEnd
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
