.head 0 +  Application Description: Centura SQLWindows Standard Application Template
.data CLASSPROPSSIZE
0000: 3B00
.enddata
.data CLASSPROPS
0000: 557365476C6F6261 6C50617468000400 0100000000417070 506174684C656E00
0020: 0400030000000041 7070506174680003 002E2E5C00000000 000000
.enddata
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000840100 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE5FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? No
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: DbvLib.apl
.head 2 -  ! File Include: SonConstantes.apl
.head 2 -  File Include: VtArray.apl
.head 2 -  File Include: Microsoft XML.apl
.head 2 -  ! File Include: SonSerializaObjeto.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 4214296097
0000: 120100006D000000 0000000000000000 02000009000000B8 0300001019000000
0020: 010000FE00FFA3D1 030019B5000100FF FF68EA03001900ED 0100FF3F03045800
0040: 00190001FB00FF8F 1C0400D6190001FE 00FFA335040019B5 000100FFFF684E04
0060: 001900ED0100FF3F 67045A00190001FB 00FF8F8004005619 000100FE00FF03
.enddata
.head 2 +  Internal Functions
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 2776137642
0000: 83070000A3030000 0000000000000000 0200000C00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F04003C00 0016630044425655
0040: 5355415200494F43 4C5542455F005665 746F72220000E000 0100000029040000
0060: 070014000001CC11 00FC00000701805B 0000000001000000 0F7063004469616C
0080: 6F67446500666175 6C74D60000EC0007 002D04000200FC00 00FF370400046B00
00A0: 0200FFFF01080000 00190000DA000100 FF7F21B000000019 00F60100FF1F3A00
00C0: 00AC00190001FD00 FF0753000000040B 0003000000FFFFC1 5700000004DA0002
00E0: 00FF7F01CC805B00 02F000127063FF41 546162D60000F607 00D6040002FE00FF
0100: 9B040004B5000200 FFFF6608001900E9 010000FFBF215900 190001FB00FF6F3A
0120: 00D6190001FE00FF 9B530004B5000300 FFFF6657000400ED 0200FF3F0180601D
0140: 0000000300E00870 63436CC065400000 0002DE0019D20001 0000FF7F19B30004
0160: 00F60300FF1F0180 1D330004000BFC70 63204B6579400000 027B00194B000100
0180: 00FFFFCD190004DA 000300FF7F010880 0400000500000000 10666344424C6900
01A0: 7374614F626A6574 11732200000100BD 0004B5000700BA01 CC00FF1001801900
01C0: 0006000000000C70 634D6F7500736557 6865656C22820000 01000000B71900F6
01E0: 0100FF1F01800433 0007000900666353 6F756E646580782A 0000000100DE003A
0200: 50000107000001D0 0024050000838001 0000007F0180800C 000000080030000A
0220: 66636E4D00657465 725E000000F60300 D6040003FE00FF9B 040004B5000300FF
0240: FF6608000400ED03 00FFBF01009D0000 0009000000000A5F 4572726F72424061
0260: 73658A01000D7800 0000194B00010000 FFFFCD190019DA00 0100FF7F32B00000
0280: 001900F60100FF1F 4B0000AC00190001 FD00FF0764000000 046B000200FFFFC1
02A0: 6800000004DA0002 00FF7F6CB0000000 0400F60200FF1F70 0000AC00040003FD
02C0: 00FF077400000004 6B000200FFFFC178 00000004DA000200 FF7F7CB000000004
02E0: 00F60300FF5F8000 AC00040003FD00FF 0784000000196B00 0100FFFF3101805B
0300: 000A000000000763 646B490074656DDE 000000077A000004 430001020000FF4F
0320: 800100FE00CD0400 04DA000200FF7F08 B3001900F4010000 FFDF21AC00190001
0340: FD00FF373A00046B 000300FFFFC13E00 000004DA000300FF 7F42B00000001900
0360: F60100FF1F01807D 000000000B000000 0D0063526164696F 4C6903426F789A00
0380: 00EC0005002D1900 0100FD00FF371900 196B000100FFFFCD 320019DA000100FF
03A0: 7F4BB3001900F601 00FFDF64AC001900 01FD00FF07
.enddata
.head 3 +  Functional Class: cDBVUSUARIOCLUBE
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nIDUSUARIO
.head 5 -  Number: nIDCLUBE
.head 5 -  Date/Time: dtVINCULADO
.head 5 -  Date/Time: dtDESVINCULADO
.head 5 -  Number: nATIVO
.head 5 -  Number: nID
.head 4 +  Functions
.head 5 +  Function: Initialize
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nID_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If Not bInitialized Or nID != nID_p
.head 8 -  Call Reset( )
.head 8 -  Set nID = nID_p
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 
'Select IDUSUARIO,  IDCLUBE,  VINCULADO,  DESVINCULADO,
ATIVO,  ID
Into  :nIDUSUARIO,  :nIDCLUBE,  :dtVINCULADO,  :dtDESVINCULADO,
:nATIVO,  :nID 
From DBVUSUARIOCLUBE 
Where ID = :nID_p' )
.head 8 +  If SqlFetchNext( hSqlParam, nFetch )
.head 9 -  Set bInitialized = TRUE
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Set bInitialized = FALSE
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nIDUSUARIO = NUMBER_Null
.head 7 -  Set nIDCLUBE = NUMBER_Null
.head 7 -  Set dtVINCULADO = DATETIME_Null
.head 7 -  Set dtDESVINCULADO = DATETIME_Null
.head 7 -  Set nATIVO = NUMBER_Null
.head 7 -  Set nID = NUMBER_Null
.head 7 -  Set bInitialized = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Clone
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: oOrigem_p
.head 8 -  Class: cDBVUSUARIOCLUBE
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nIDUSUARIO = oOrigem_p.nIDUSUARIO
.head 7 -  Set nIDCLUBE = oOrigem_p.nIDCLUBE
.head 7 -  Set dtVINCULADO = oOrigem_p.dtVINCULADO
.head 7 -  Set dtDESVINCULADO = oOrigem_p.dtDESVINCULADO
.head 7 -  Set nATIVO = oOrigem_p.nATIVO
.head 7 -  Set nID = oOrigem_p.nID
.head 7 -  Set bInitialized = FALSE
.head 5 +  Function: Insert
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bUpdate
.head 6 +  Actions
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 +  When SqlError
.head 9 -  Set bUpdate = TRUE
.head 9 -  Return FALSE
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into DBVUSUARIOCLUBE 
( IDUSUARIO,  IDCLUBE,  VINCULADO,  DESVINCULADO,
ATIVO,  ID )
 Values 
( :nIDUSUARIO,  :nIDCLUBE,  :dtVINCULADO,  :dtDESVINCULADO,
:nATIVO,  :nID ) ' )
.head 8 +  If bUpdate
.head 9 -  Call Update( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: InsertOrHalt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into DBVUSUARIOCLUBE 
( IDUSUARIO,  IDCLUBE,  VINCULADO,  DESVINCULADO,
ATIVO,  ID )
 Values 
( :nIDUSUARIO,  :nIDCLUBE,  :dtVINCULADO,  :dtDESVINCULADO,
:nATIVO,  :nID ) ' )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: Delete
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If VerificaDependencias() And VerificaDependenciasCustom( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Delete From DBVUSUARIOCLUBE
Where ID = :nID' )
.head 8 -  Call DeleteDependencies( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call Reset( )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: Update
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Update DBVUSUARIOCLUBE
Set IDUSUARIO = :nIDUSUARIO,
IDCLUBE = :nIDCLUBE,
VINCULADO = :dtVINCULADO,
DESVINCULADO = :dtDESVINCULADO,
ATIVO = :nATIVO 
Where ID = :nID ' )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, 'RL' )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: VerificaCampos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! Call oErro.Initialize()
.head 7 -  Return TRUE
.head 5 +  Function: GetClassName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return 'cDBVUSUARIOCLUBE'
.head 5 +  Function: FazOperacaoDB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nOperacao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bReturn
.head 6 +  Actions
.head 7 -  Set bReturn = ExecutaComandoDB( hSqlParam, nOperacao )
.head 7 -  Return bReturn
.head 5 +  Function: VerificaDependencias
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: RegistraOperacao
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nFuncao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSeqNo
.head 7 -  Date/Time: dtAtual
.head 7 -  String: sFuncao
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'IDUSUARIO\', 0, ' || SalNumberToStrX( nIDUSUARIO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'IDCLUBE\', 1, ' || SalNumberToStrX( nIDCLUBE, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'VINCULADO\', 2, ' || SalFmtFormatDateTime( dtVINCULADO, 'yyyyMMddhhhhmmss' )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'DESVINCULADO\', 3, ' || SalFmtFormatDateTime( dtDESVINCULADO, 'yyyyMMddhhhhmmss' )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'ATIVO\', 4, ' || SalNumberToStrX( nATIVO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'ID\', 5, ' || SalNumberToStrX( nID, 7 )  || '  )'  )
.head 7 -  Return TRUE
.head 5 +  Function: GetMaxID
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMAXID
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Select MAX(ID) Into :nMAXID From DBVUSUARIOCLUBE' )
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 -  Return isNullNumber(nMAXID,0)
.head 5 +  Function: GetNextID
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMAXID
.head 7 -  Number: nMAXIDBloq
.head 6 +  Actions
.head 7 -  Set nMAXID = GetMaxID( hSqlParam )
.head 7 +  If nMAXIDBloq >= nMAXID
.head 8 -  Return (nMAXIDBloq + 1)
.head 7 -  Return (nMAXID + 1)
.head 5 -  ! @CustomMethodsBegin
.head 5 +  Function: InitializeByFK
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: npIDUsuario
.head 7 -  Number: npIDClube
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If Not bInitialized Or nIDUSUARIO != npIDUsuario Or nIDCLUBE != npIDClube
.head 8 -  Call Reset( )
.head 8 -  Set nIDUSUARIO = npIDUsuario
.head 8 -  Set nIDCLUBE = npIDClube
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, "Select ID Into :nID From DBVUSUARIOCLUBE Where IDUSUARIO = :npIDUsuario and IDCLUBE = :npIDClube  " )
.head 8 +  If SqlFetchNext( hSqlParam, nFetch )
.head 9 -  Return Initialize( hSqlParam, nID )
.head 8 +  Else
.head 9 -  Set bInitialized = FALSE
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Function: VerificaCamposCustom
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: VerificaDependenciasCustom
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: DeleteDependencies
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  ! @CustomMethodsEnd
.head 3 +  Functional Class: cDBVUSUARIOCLUBE_Vetor
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBListaObjetos
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sOrdemCampos
.head 5 -  String: saAtributosXML[*,2]
.head 5 -  FunctionalVar: oDBVUSUARIOCLUBE[*]
.head 6 -  Class: cDBVUSUARIOCLUBE
.head 4 +  Functions
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( oDBVUSUARIOCLUBE , 1, -1 )
.head 7 +  If sOrdemCampos = ''
.head 8 -  Set sOrdemCampos = ' ID '
.head 7 -  Set bInitialized = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Select
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nInd
.head 7 -  String: sTop
.head 6 +  Actions
.head 7 -  Call Reset()
.head 7 -  Set sWhere = ''
.head 7 -  Call PrepareConditions()
.head 7 -  Set nInd = 0
.head 7 +  If nTopResultados+0 > 0
.head 8 -  Set sTop = ' Top ' || SalNumberToStrX( nTopResultados, 0 )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
Select IDUSUARIO,  IDCLUBE,  VINCULADO,  DESVINCULADO,
ATIVO,  ID
Into  :oDBVUSUARIOCLUBE[nInd].nIDUSUARIO,  :oDBVUSUARIOCLUBE[nInd].nIDCLUBE,  :oDBVUSUARIOCLUBE[nInd].dtVINCULADO,
:oDBVUSUARIOCLUBE[nInd].dtDESVINCULADO,  :oDBVUSUARIOCLUBE[nInd].nATIVO,  :oDBVUSUARIOCLUBE[nInd].nID 
From DBVUSUARIOCLUBE ' || sWhere || ' 
Order By ' || sOrdemCampos )
.head 7 +  While SqlFetchNext( hSqlParam, nFetch )
.head 8 -  Set nInd = nInd + 1
.head 7 -  Set nCount = nInd
.head 7 -  Set sOrdemCampos = ''
.head 7 -  Call FreeConditions(  )
.head 7 -  Return nInd
.head 5 +  Function: SelectCount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nInd
.head 6 +  Actions
.head 7 -  Set sWhere = ''
.head 7 -  Call PrepareConditions()
.head 7 -  Set nInd = 0
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
Select Count(*)
into :nCount
From DBVUSUARIOCLUBE ' || sWhere )
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 -  Return nCount
.head 5 +  Function: SetClassVarNameValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVetorPos
.head 7 -  String: sNomeVar
.head 7 -  String: sValor
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sNomeVar = 'nIDUSUARIO'
.head 8 -  Set oDBVUSUARIOCLUBE[nVetorPos].nIDUSUARIO = SalStrToNumber( sValor )
.head 7 +  Else If sNomeVar = 'nIDCLUBE'
.head 8 -  Set oDBVUSUARIOCLUBE[nVetorPos].nIDCLUBE = SalStrToNumber( sValor )
.head 7 +  Else If sNomeVar = 'dtVINCULADO'
.head 8 -  Set oDBVUSUARIOCLUBE[nVetorPos].dtVINCULADO = FormataDataLida( sValor) 
.head 7 +  Else If sNomeVar = 'dtDESVINCULADO'
.head 8 -  Set oDBVUSUARIOCLUBE[nVetorPos].dtDESVINCULADO = FormataDataLida( sValor) 
.head 7 +  Else If sNomeVar = 'nATIVO'
.head 8 -  Set oDBVUSUARIOCLUBE[nVetorPos].nATIVO = SalStrToNumber( sValor )
.head 7 +  Else If sNomeVar = 'nID'
.head 8 -  Set oDBVUSUARIOCLUBE[nVetorPos].nID = SalStrToNumber( sValor )
.head 7 -  Return TRUE
.head 5 +  Function: GetClassVarNameValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  FunctionalVar: (no name)
.head 8 -  Class: Variant
.head 6 +  Parameters
.head 7 -  String: sNomeVar
.head 7 -  Number: nVetorPos
.head 6 +  Static Variables
.head 7 -  FunctionalVar: vParamExport
.head 8 -  Class: Variant
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sNomeVar = 'nIDUSUARIO'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIOCLUBE[nVetorPos].nIDUSUARIO , VT_R8 )
.head 7 +  Else If sNomeVar = 'nIDCLUBE'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIOCLUBE[nVetorPos].nIDCLUBE , VT_R8 )
.head 7 +  Else If sNomeVar = 'dtVINCULADO'
.head 8 -  Call vParamExport.SetDate( oDBVUSUARIOCLUBE[nVetorPos].dtVINCULADO)
.head 7 +  Else If sNomeVar = 'dtDESVINCULADO'
.head 8 -  Call vParamExport.SetDate( oDBVUSUARIOCLUBE[nVetorPos].dtDESVINCULADO)
.head 7 +  Else If sNomeVar = 'nATIVO'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIOCLUBE[nVetorPos].nATIVO , VT_R8 )
.head 7 +  Else If sNomeVar = 'nID'
.head 8 -  Call vParamExport.SetNumber( oDBVUSUARIOCLUBE[nVetorPos].nID , VT_R8 )
.head 7 -  Return vParamExport
.head 5 +  Function: GetClassName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return 'cDBVUSUARIOCLUBE'
.head 5 +  Function: ConditionOk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVetorPos
.head 7 -  String: sColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Date/Time: dtReturn
.head 7 -  Number: nIndice
.head 7 -  Number: nError
.head 7 -  Number: nErrorPos
.head 7 -  Number: nReturn
.head 7 -  String: sCondicao
.head 7 -  String: sReturn
.head 7 -  Window Handle: hWndReturn
.head 6 +  Actions
.head 7 -  Set nIndice = VisArrayFindString( sColunasLog, sColuna )
.head 7 +  If nIndice >= 0
.head 8 -  Set sCondicao = VisStrSubstitute( sConditionsLog[nIndice], '%COLUNA', 'oDBVUSUARIOCLUBE[ nVetorPos ].' || sColuna )
.head 8 -  Call SalCompileAndEvaluate( sCondicao, nError, nErrorPos, nReturn, sReturn, dtReturn, hWndReturn, TRUE, SalContextCurrent( ) )
.head 8 -  Return nReturn
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Function: ProcessaReg
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nLinha
.head 7 -  String: sOperacao
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sOperacao = '11'
.head 8 -  Return oDBVUSUARIOCLUBE[nLinha].Insert( hSqlParam )
.head 7 +  Else If sOperacao = '22'
.head 8 -  Return oDBVUSUARIOCLUBE[nLinha].Delete( hSqlParam )
.head 7 +  Else If sOperacao = '33'
.head 8 -  Return oDBVUSUARIOCLUBE[nLinha].Update( hSqlParam )
.head 5 -  ! @ArrayCustomMethodsBegin
.head 5 -  ! @ArrayCustomMethodsEnd
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
